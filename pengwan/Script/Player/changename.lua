--[[
file: changename.lua
desc: changename
autor: csj
update: 2013-8-12
--]]

---------------------------------------------
--include:

local db_module = require('Script.cext.dbrpc')
local db_change_name = db_module.db_change_name
local db_change_name_rollback = db_module.db_change_name_rollback
local define = require('Script.cext.define')
local FACTION_BZ = define.FACTION_BZ

---------------------------------------------
--inner:

-- @optype: [1] 改玩家名 [2] 改帮会名
local function _change_name(sid,optype,newname)
	if sid == nil or optype == nil or type(newname) ~= type('') then
		look('_change_name param erro')
		return
	end
	
	if optype == 1 then
		if CheckGoods( 680 ,1, 1, sid,'修改角色名') == 0 then			
			RPC('change_name',optype,1)
			return
		end
		-- look('newname:' .. newname)
		db_change_name(sid,optype,newname,sid)
	elseif optype == 2 then
		if(is_auto_faction_name(newname))then
			RPC('change_name',optype,3)
			return
		end
		if CheckGoods( 681 ,1, 1, sid,'修改帮会名') == 0 then			
			RPC('change_name',optype,1)
			return
		end
		local fid = CI_GetPlayerData(23,2,sid)
		if fid == nil or fid <= 0 then
			RPC('change_name',optype,2)			-- 没有帮会
			return
		end
		local title = CI_GetMemberInfo(1)
		if title == nil or title <= 0 then
			RPC('change_name',optype,2)			-- 没有帮会
			return 
		end
		if title < FACTION_BZ then
			RPC('change_name',optype,2)			-- 不是帮主不能改名
			return
		end
		db_change_name(fid,optype,newname,sid)
	end
end

function CALLBACK_changename(id,optype,newname,sid,rs)
	-- look('CALLBACK_changename:' .. id)
	-- look('CALLBACK_changename:' .. optype)
	-- look('CALLBACK_changename:' .. newname)
	-- look('CALLBACK_changename:' .. rs)
	if id == nil or optype == nil or sid == nil or type(newname) ~= type('') then
		return
	end
	if rs == nil then		
		return
	end
	if rs == 0 then		-- 更新失败(重名/名字不合法)
		RPC('change_name',optype,3)
		return
	end
	-- 先扣道具或元宝
	if optype == 1 then
		if CheckGoods( 680, 1, 0, sid, '修改角色名') == 0 then
			-- 需要回滚
			db_change_name_rollback(id,optype,newname)
			return
		end
		local oldname = CI_GetPlayerData(5,2,sid)
		local ret = CI_SetPlayerData(3,newname,2,sid)
		-- look('CALLBACK_changename ret1 = ' .. tostring(ret))
		-- 如果对方在线,更新夫/妻名字
		local mpMarryData = GetPlayerMarryData(sid)
		if mpMarryData == nil then return end
		if mpMarryData[4] then
			local fplayerid = mpMarryData[4]
			if IsPlayerOnline(fplayerid) then
				SetSpouse(fplayerid,newname)
				RPCEx(fplayerid,'cp_rename',newname)
			end
		end
		-- 修改任务
		local taskData = GetDBTaskData(sid)
		if taskData and taskData.current then 
			for k, v in pairs(taskData.current) do
				if type(k) == type(0) and type(v) == type({}) then
					if v.kill and v.kill[oldname] then
						v.kill[newname] = v.kill[oldname]
						v.kill[oldname] = nil
					end
				end
			end
		end		
		RPC('change_name',optype,0)
	elseif optype == 2 then
		if CheckGoods( 681, 1, 0, sid, '修改帮会名') == 0 then
			-- 需要回滚
			db_change_name_rollback(id,optype,newname)
			return
		end
		local ret = CI_SetFactionInfo(id,1,newname)
		if ret == -1 then	-- 重名
			-- 需要回滚
			db_change_name_rollback(id,optype,newname)
			RPC('change_name',optype,3)
			return
		end
		-- look('CALLBACK_changename ret2 = ' .. tostring(ret))
		FactionRPC(id,'change_name',optype,0,newname)
	end			
end

--------------------------------------------------------------
--interface:

change_name = _change_name





--转职变性装备转换配置
--武器
local change_Weaponconf={--10代表1职业0性别(1男,0女)
	--将军男
	[5000]={[10]=5037,[11]=5000,[20]=5111,[21]=5074,[30]=5185,[31]=5148},
	[5001]={[10]=5038,[11]=5001,[20]=5112,[21]=5075,[30]=5186,[31]=5149},
	[5004]={[10]=5041,[11]=5004,[20]=5115,[21]=5078,[30]=5189,[31]=5152},
	[5007]={[10]=5044,[11]=5007,[20]=5118,[21]=5081,[30]=5192,[31]=5155},
	[5009]={[10]=5046,[11]=5009,[20]=5120,[21]=5083,[30]=5194,[31]=5157},
	[5010]={[10]=5047,[11]=5010,[20]=5121,[21]=5084,[30]=5195,[31]=5158},
	[5011]={[10]=5048,[11]=5011,[20]=5122,[21]=5085,[30]=5196,[31]=5159},
	[5012]={[10]=5049,[11]=5012,[20]=5123,[21]=5086,[30]=5197,[31]=5160},
	[5013]={[10]=5050,[11]=5013,[20]=5124,[21]=5087,[30]=5198,[31]=5161},
	[5014]={[10]=5051,[11]=5014,[20]=5125,[21]=5088,[30]=5199,[31]=5162},
	[5015]={[10]=5052,[11]=5015,[20]=5126,[21]=5089,[30]=5200,[31]=5163},
	[5016]={[10]=5053,[11]=5016,[20]=5127,[21]=5090,[30]=5201,[31]=5164},
	[5017]={[10]=5054,[11]=5017,[20]=5128,[21]=5091,[30]=5202,[31]=5165},
	[5018]={[10]=5055,[11]=5018,[20]=5129,[21]=5092,[30]=5203,[31]=5166},
	[5019]={[10]=5056,[11]=5019,[20]=5130,[21]=5093,[30]=5204,[31]=5167},
	[5020]={[10]=5057,[11]=5020,[20]=5131,[21]=5094,[30]=5205,[31]=5168},
	[5021]={[10]=5058,[11]=5021,[20]=5132,[21]=5095,[30]=5206,[31]=5169},
	[5022]={[10]=5059,[11]=5022,[20]=5133,[21]=5096,[30]=5207,[31]=5170},
	[5023]={[10]=5060,[11]=5023,[20]=5134,[21]=5097,[30]=5208,[31]=5171},
	[5024]={[10]=5061,[11]=5024,[20]=5135,[21]=5098,[30]=5209,[31]=5172},
	[5025]={[10]=5062,[11]=5025,[20]=5136,[21]=5099,[30]=5210,[31]=5173},
	[5026]={[10]=5063,[11]=5026,[20]=5137,[21]=5100,[30]=5211,[31]=5174},
	[5027]={[10]=5064,[11]=5027,[20]=5138,[21]=5101,[30]=5212,[31]=5175},
	[5028]={[10]=5065,[11]=5028,[20]=5139,[21]=5102,[30]=5213,[31]=5176},
	[5029]={[10]=5066,[11]=5029,[20]=5140,[21]=5103,[30]=5214,[31]=5177},
	[5030]={[10]=5067,[11]=5030,[20]=5141,[21]=5104,[30]=5215,[31]=5178},
	[5031]={[10]=5068,[11]=5031,[20]=5142,[21]=5105,[30]=5216,[31]=5179},
	[5032]={[10]=5069,[11]=5032,[20]=5143,[21]=5106,[30]=5217,[31]=5180},
	[5033]={[10]=5070,[11]=5033,[20]=5144,[21]=5107,[30]=5218,[31]=5181},
	[5034]={[10]=5071,[11]=5034,[20]=5145,[21]=5108,[30]=5219,[31]=5182},
	[5035]={[10]=5072,[11]=5035,[20]=5146,[21]=5109,[30]=5220,[31]=5183},
	[5036]={[10]=5073,[11]=5036,[20]=5147,[21]=5110,[30]=5221,[31]=5184},
	--将军女
	[5037]={[10]=5037,[11]=5000,[20]=5111,[21]=5074,[30]=5185,[31]=5148},
	[5038]={[10]=5038,[11]=5001,[20]=5112,[21]=5075,[30]=5186,[31]=5149},
	[5041]={[10]=5041,[11]=5004,[20]=5115,[21]=5078,[30]=5189,[31]=5152},
	[5044]={[10]=5044,[11]=5007,[20]=5118,[21]=5081,[30]=5192,[31]=5155},
	[5046]={[10]=5046,[11]=5009,[20]=5120,[21]=5083,[30]=5194,[31]=5157},
	[5047]={[10]=5047,[11]=5010,[20]=5121,[21]=5084,[30]=5195,[31]=5158},
	[5048]={[10]=5048,[11]=5011,[20]=5122,[21]=5085,[30]=5196,[31]=5159},
	[5049]={[10]=5049,[11]=5012,[20]=5123,[21]=5086,[30]=5197,[31]=5160},
	[5050]={[10]=5050,[11]=5013,[20]=5124,[21]=5087,[30]=5198,[31]=5161},
	[5051]={[10]=5051,[11]=5014,[20]=5125,[21]=5088,[30]=5199,[31]=5162},
	[5052]={[10]=5052,[11]=5015,[20]=5126,[21]=5089,[30]=5200,[31]=5163},
	[5053]={[10]=5053,[11]=5016,[20]=5127,[21]=5090,[30]=5201,[31]=5164},
	[5054]={[10]=5054,[11]=5017,[20]=5128,[21]=5091,[30]=5202,[31]=5165},
	[5055]={[10]=5055,[11]=5018,[20]=5129,[21]=5092,[30]=5203,[31]=5166},
	[5056]={[10]=5056,[11]=5019,[20]=5130,[21]=5093,[30]=5204,[31]=5167},
	[5057]={[10]=5057,[11]=5020,[20]=5131,[21]=5094,[30]=5205,[31]=5168},
	[5058]={[10]=5058,[11]=5021,[20]=5132,[21]=5095,[30]=5206,[31]=5169},
	[5059]={[10]=5059,[11]=5022,[20]=5133,[21]=5096,[30]=5207,[31]=5170},
	[5060]={[10]=5060,[11]=5023,[20]=5134,[21]=5097,[30]=5208,[31]=5171},
	[5061]={[10]=5061,[11]=5024,[20]=5135,[21]=5098,[30]=5209,[31]=5172},
	[5062]={[10]=5062,[11]=5025,[20]=5136,[21]=5099,[30]=5210,[31]=5173},
	[5063]={[10]=5063,[11]=5026,[20]=5137,[21]=5100,[30]=5211,[31]=5174},
	[5064]={[10]=5064,[11]=5027,[20]=5138,[21]=5101,[30]=5212,[31]=5175},
	[5065]={[10]=5065,[11]=5028,[20]=5139,[21]=5102,[30]=5213,[31]=5176},
	[5066]={[10]=5066,[11]=5029,[20]=5140,[21]=5103,[30]=5214,[31]=5177},
	[5067]={[10]=5067,[11]=5030,[20]=5141,[21]=5104,[30]=5215,[31]=5178},
	[5068]={[10]=5068,[11]=5031,[20]=5142,[21]=5105,[30]=5216,[31]=5179},
	[5069]={[10]=5069,[11]=5032,[20]=5143,[21]=5106,[30]=5217,[31]=5180},
	[5070]={[10]=5070,[11]=5033,[20]=5144,[21]=5107,[30]=5218,[31]=5181},
	[5071]={[10]=5071,[11]=5034,[20]=5145,[21]=5108,[30]=5219,[31]=5182},
	[5072]={[10]=5072,[11]=5035,[20]=5146,[21]=5109,[30]=5220,[31]=5183},
	[5073]={[10]=5073,[11]=5036,[20]=5147,[21]=5110,[30]=5221,[31]=5184},
	--修仙男
	[5074]={[10]=5037,[11]=5000,[20]=5111,[21]=5074,[30]=5185,[31]=5148},
	[5075]={[10]=5038,[11]=5001,[20]=5112,[21]=5075,[30]=5186,[31]=5149},
	[5078]={[10]=5041,[11]=5004,[20]=5115,[21]=5078,[30]=5189,[31]=5152},
	[5081]={[10]=5044,[11]=5007,[20]=5118,[21]=5081,[30]=5192,[31]=5155},
	[5083]={[10]=5046,[11]=5009,[20]=5120,[21]=5083,[30]=5194,[31]=5157},
	[5084]={[10]=5047,[11]=5010,[20]=5121,[21]=5084,[30]=5195,[31]=5158},
	[5085]={[10]=5048,[11]=5011,[20]=5122,[21]=5085,[30]=5196,[31]=5159},
	[5086]={[10]=5049,[11]=5012,[20]=5123,[21]=5086,[30]=5197,[31]=5160},
	[5087]={[10]=5050,[11]=5013,[20]=5124,[21]=5087,[30]=5198,[31]=5161},
	[5088]={[10]=5051,[11]=5014,[20]=5125,[21]=5088,[30]=5199,[31]=5162},
	[5089]={[10]=5052,[11]=5015,[20]=5126,[21]=5089,[30]=5200,[31]=5163},
	[5090]={[10]=5053,[11]=5016,[20]=5127,[21]=5090,[30]=5201,[31]=5164},
	[5091]={[10]=5054,[11]=5017,[20]=5128,[21]=5091,[30]=5202,[31]=5165},
	[5092]={[10]=5055,[11]=5018,[20]=5129,[21]=5092,[30]=5203,[31]=5166},
	[5093]={[10]=5056,[11]=5019,[20]=5130,[21]=5093,[30]=5204,[31]=5167},
	[5094]={[10]=5057,[11]=5020,[20]=5131,[21]=5094,[30]=5205,[31]=5168},
	[5095]={[10]=5058,[11]=5021,[20]=5132,[21]=5095,[30]=5206,[31]=5169},
	[5096]={[10]=5059,[11]=5022,[20]=5133,[21]=5096,[30]=5207,[31]=5170},
	[5097]={[10]=5060,[11]=5023,[20]=5134,[21]=5097,[30]=5208,[31]=5171},
	[5098]={[10]=5061,[11]=5024,[20]=5135,[21]=5098,[30]=5209,[31]=5172},
	[5099]={[10]=5062,[11]=5025,[20]=5136,[21]=5099,[30]=5210,[31]=5173},
	[5100]={[10]=5063,[11]=5026,[20]=5137,[21]=5100,[30]=5211,[31]=5174},
	[5101]={[10]=5064,[11]=5027,[20]=5138,[21]=5101,[30]=5212,[31]=5175},
	[5102]={[10]=5065,[11]=5028,[20]=5139,[21]=5102,[30]=5213,[31]=5176},
	[5103]={[10]=5066,[11]=5029,[20]=5140,[21]=5103,[30]=5214,[31]=5177},
	[5104]={[10]=5067,[11]=5030,[20]=5141,[21]=5104,[30]=5215,[31]=5178},
	[5105]={[10]=5068,[11]=5031,[20]=5142,[21]=5105,[30]=5216,[31]=5179},
	[5106]={[10]=5069,[11]=5032,[20]=5143,[21]=5106,[30]=5217,[31]=5180},
	[5107]={[10]=5070,[11]=5033,[20]=5144,[21]=5107,[30]=5218,[31]=5181},
	[5108]={[10]=5071,[11]=5034,[20]=5145,[21]=5108,[30]=5219,[31]=5182},
	[5109]={[10]=5072,[11]=5035,[20]=5146,[21]=5109,[30]=5220,[31]=5183},
	[5110]={[10]=5073,[11]=5036,[20]=5147,[21]=5110,[30]=5221,[31]=5184},
	--修仙女
	[5111]={[10]=5037,[11]=5000,[20]=5111,[21]=5074,[30]=5185,[31]=5148},
	[5112]={[10]=5038,[11]=5001,[20]=5112,[21]=5075,[30]=5186,[31]=5149},
	[5115]={[10]=5041,[11]=5004,[20]=5115,[21]=5078,[30]=5189,[31]=5152},
	[5118]={[10]=5044,[11]=5007,[20]=5118,[21]=5081,[30]=5192,[31]=5155},
	[5120]={[10]=5046,[11]=5009,[20]=5120,[21]=5083,[30]=5194,[31]=5157},
	[5121]={[10]=5047,[11]=5010,[20]=5121,[21]=5084,[30]=5195,[31]=5158},
	[5122]={[10]=5048,[11]=5011,[20]=5122,[21]=5085,[30]=5196,[31]=5159},
	[5123]={[10]=5049,[11]=5012,[20]=5123,[21]=5086,[30]=5197,[31]=5160},
	[5124]={[10]=5050,[11]=5013,[20]=5124,[21]=5087,[30]=5198,[31]=5161},
	[5125]={[10]=5051,[11]=5014,[20]=5125,[21]=5088,[30]=5199,[31]=5162},
	[5126]={[10]=5052,[11]=5015,[20]=5126,[21]=5089,[30]=5200,[31]=5163},
	[5127]={[10]=5053,[11]=5016,[20]=5127,[21]=5090,[30]=5201,[31]=5164},
	[5128]={[10]=5054,[11]=5017,[20]=5128,[21]=5091,[30]=5202,[31]=5165},
	[5129]={[10]=5055,[11]=5018,[20]=5129,[21]=5092,[30]=5203,[31]=5166},
	[5130]={[10]=5056,[11]=5019,[20]=5130,[21]=5093,[30]=5204,[31]=5167},
	[5131]={[10]=5057,[11]=5020,[20]=5131,[21]=5094,[30]=5205,[31]=5168},
	[5132]={[10]=5058,[11]=5021,[20]=5132,[21]=5095,[30]=5206,[31]=5169},
	[5133]={[10]=5059,[11]=5022,[20]=5133,[21]=5096,[30]=5207,[31]=5170},
	[5134]={[10]=5060,[11]=5023,[20]=5134,[21]=5097,[30]=5208,[31]=5171},
	[5135]={[10]=5061,[11]=5024,[20]=5135,[21]=5098,[30]=5209,[31]=5172},
	[5136]={[10]=5062,[11]=5025,[20]=5136,[21]=5099,[30]=5210,[31]=5173},
	[5137]={[10]=5063,[11]=5026,[20]=5137,[21]=5100,[30]=5211,[31]=5174},
	[5138]={[10]=5064,[11]=5027,[20]=5138,[21]=5101,[30]=5212,[31]=5175},
	[5139]={[10]=5065,[11]=5028,[20]=5139,[21]=5102,[30]=5213,[31]=5176},
	[5140]={[10]=5066,[11]=5029,[20]=5140,[21]=5103,[30]=5214,[31]=5177},
	[5141]={[10]=5067,[11]=5030,[20]=5141,[21]=5104,[30]=5215,[31]=5178},
	[5142]={[10]=5068,[11]=5031,[20]=5142,[21]=5105,[30]=5216,[31]=5179},
	[5143]={[10]=5069,[11]=5032,[20]=5143,[21]=5106,[30]=5217,[31]=5180},
	[5144]={[10]=5070,[11]=5033,[20]=5144,[21]=5107,[30]=5218,[31]=5181},
	[5145]={[10]=5071,[11]=5034,[20]=5145,[21]=5108,[30]=5219,[31]=5182},
	[5146]={[10]=5072,[11]=5035,[20]=5146,[21]=5109,[30]=5220,[31]=5183},
	[5147]={[10]=5073,[11]=5036,[20]=5147,[21]=5110,[30]=5221,[31]=5184},
	--九黎男
	[5148]={[10]=5037,[11]=5000,[20]=5111,[21]=5074,[30]=5185,[31]=5148},
	[5149]={[10]=5038,[11]=5001,[20]=5112,[21]=5075,[30]=5186,[31]=5149},
	[5152]={[10]=5041,[11]=5004,[20]=5115,[21]=5078,[30]=5189,[31]=5152},
	[5155]={[10]=5044,[11]=5007,[20]=5118,[21]=5081,[30]=5192,[31]=5155},
	[5157]={[10]=5046,[11]=5009,[20]=5120,[21]=5083,[30]=5194,[31]=5157},
	[5158]={[10]=5047,[11]=5010,[20]=5121,[21]=5084,[30]=5195,[31]=5158},
	[5159]={[10]=5048,[11]=5011,[20]=5122,[21]=5085,[30]=5196,[31]=5159},
	[5160]={[10]=5049,[11]=5012,[20]=5123,[21]=5086,[30]=5197,[31]=5160},
	[5161]={[10]=5050,[11]=5013,[20]=5124,[21]=5087,[30]=5198,[31]=5161},
	[5162]={[10]=5051,[11]=5014,[20]=5125,[21]=5088,[30]=5199,[31]=5162},
	[5163]={[10]=5052,[11]=5015,[20]=5126,[21]=5089,[30]=5200,[31]=5163},
	[5164]={[10]=5053,[11]=5016,[20]=5127,[21]=5090,[30]=5201,[31]=5164},
	[5165]={[10]=5054,[11]=5017,[20]=5128,[21]=5091,[30]=5202,[31]=5165},
	[5166]={[10]=5055,[11]=5018,[20]=5129,[21]=5092,[30]=5203,[31]=5166},
	[5167]={[10]=5056,[11]=5019,[20]=5130,[21]=5093,[30]=5204,[31]=5167},
	[5168]={[10]=5057,[11]=5020,[20]=5131,[21]=5094,[30]=5205,[31]=5168},
	[5169]={[10]=5058,[11]=5021,[20]=5132,[21]=5095,[30]=5206,[31]=5169},
	[5170]={[10]=5059,[11]=5022,[20]=5133,[21]=5096,[30]=5207,[31]=5170},
	[5171]={[10]=5060,[11]=5023,[20]=5134,[21]=5097,[30]=5208,[31]=5171},
	[5172]={[10]=5061,[11]=5024,[20]=5135,[21]=5098,[30]=5209,[31]=5172},
	[5173]={[10]=5062,[11]=5025,[20]=5136,[21]=5099,[30]=5210,[31]=5173},
	[5174]={[10]=5063,[11]=5026,[20]=5137,[21]=5100,[30]=5211,[31]=5174},
	[5175]={[10]=5064,[11]=5027,[20]=5138,[21]=5101,[30]=5212,[31]=5175},
	[5176]={[10]=5065,[11]=5028,[20]=5139,[21]=5102,[30]=5213,[31]=5176},
	[5177]={[10]=5066,[11]=5029,[20]=5140,[21]=5103,[30]=5214,[31]=5177},
	[5178]={[10]=5067,[11]=5030,[20]=5141,[21]=5104,[30]=5215,[31]=5178},
	[5179]={[10]=5068,[11]=5031,[20]=5142,[21]=5105,[30]=5216,[31]=5179},
	[5180]={[10]=5069,[11]=5032,[20]=5143,[21]=5106,[30]=5217,[31]=5180},
	[5181]={[10]=5070,[11]=5033,[20]=5144,[21]=5107,[30]=5218,[31]=5181},
	[5182]={[10]=5071,[11]=5034,[20]=5145,[21]=5108,[30]=5219,[31]=5182},
	[5183]={[10]=5072,[11]=5035,[20]=5146,[21]=5109,[30]=5220,[31]=5183},
	[5184]={[10]=5073,[11]=5036,[20]=5147,[21]=5110,[30]=5221,[31]=5184},
	--九黎女
	[5185]={[10]=5037,[11]=5000,[20]=5111,[21]=5074,[30]=5185,[31]=5148},
	[5186]={[10]=5038,[11]=5001,[20]=5112,[21]=5075,[30]=5186,[31]=5149},
	[5189]={[10]=5041,[11]=5004,[20]=5115,[21]=5078,[30]=5189,[31]=5152},
	[5192]={[10]=5044,[11]=5007,[20]=5118,[21]=5081,[30]=5192,[31]=5155},
	[5194]={[10]=5046,[11]=5009,[20]=5120,[21]=5083,[30]=5194,[31]=5157},
	[5195]={[10]=5047,[11]=5010,[20]=5121,[21]=5084,[30]=5195,[31]=5158},
	[5196]={[10]=5048,[11]=5011,[20]=5122,[21]=5085,[30]=5196,[31]=5159},
	[5197]={[10]=5049,[11]=5012,[20]=5123,[21]=5086,[30]=5197,[31]=5160},
	[5198]={[10]=5050,[11]=5013,[20]=5124,[21]=5087,[30]=5198,[31]=5161},
	[5199]={[10]=5051,[11]=5014,[20]=5125,[21]=5088,[30]=5199,[31]=5162},
	[5200]={[10]=5052,[11]=5015,[20]=5126,[21]=5089,[30]=5200,[31]=5163},
	[5201]={[10]=5053,[11]=5016,[20]=5127,[21]=5090,[30]=5201,[31]=5164},
	[5202]={[10]=5054,[11]=5017,[20]=5128,[21]=5091,[30]=5202,[31]=5165},
	[5203]={[10]=5055,[11]=5018,[20]=5129,[21]=5092,[30]=5203,[31]=5166},
	[5204]={[10]=5056,[11]=5019,[20]=5130,[21]=5093,[30]=5204,[31]=5167},
	[5205]={[10]=5057,[11]=5020,[20]=5131,[21]=5094,[30]=5205,[31]=5168},
	[5206]={[10]=5058,[11]=5021,[20]=5132,[21]=5095,[30]=5206,[31]=5169},
	[5207]={[10]=5059,[11]=5022,[20]=5133,[21]=5096,[30]=5207,[31]=5170},
	[5208]={[10]=5060,[11]=5023,[20]=5134,[21]=5097,[30]=5208,[31]=5171},
	[5209]={[10]=5061,[11]=5024,[20]=5135,[21]=5098,[30]=5209,[31]=5172},
	[5210]={[10]=5062,[11]=5025,[20]=5136,[21]=5099,[30]=5210,[31]=5173},
	[5211]={[10]=5063,[11]=5026,[20]=5137,[21]=5100,[30]=5211,[31]=5174},
	[5212]={[10]=5064,[11]=5027,[20]=5138,[21]=5101,[30]=5212,[31]=5175},
	[5213]={[10]=5065,[11]=5028,[20]=5139,[21]=5102,[30]=5213,[31]=5176},
	[5214]={[10]=5066,[11]=5029,[20]=5140,[21]=5103,[30]=5214,[31]=5177},
	[5215]={[10]=5067,[11]=5030,[20]=5141,[21]=5104,[30]=5215,[31]=5178},
	[5216]={[10]=5068,[11]=5031,[20]=5142,[21]=5105,[30]=5216,[31]=5179},
	[5217]={[10]=5069,[11]=5032,[20]=5143,[21]=5106,[30]=5217,[31]=5180},
	[5218]={[10]=5070,[11]=5033,[20]=5144,[21]=5107,[30]=5218,[31]=5181},
	[5219]={[10]=5071,[11]=5034,[20]=5145,[21]=5108,[30]=5219,[31]=5182},
	[5220]={[10]=5072,[11]=5035,[20]=5146,[21]=5109,[30]=5220,[31]=5183},
	[5221]={[10]=5073,[11]=5036,[20]=5147,[21]=5110,[30]=5221,[31]=5184},

}
--衣服裤子鞋子
local change_otherconf={
	--裤子
	[5222]={[1]=5222,[2]=5259,[3]=5296},
	[5223]={[1]=5223,[2]=5260,[3]=5297},
	[5226]={[1]=5226,[2]=5263,[3]=5300},
	[5229]={[1]=5229,[2]=5266,[3]=5303},
	[5231]={[1]=5231,[2]=5268,[3]=5305},
	[5232]={[1]=5232,[2]=5269,[3]=5306},
	[5233]={[1]=5233,[2]=5270,[3]=5307},
	[5234]={[1]=5234,[2]=5271,[3]=5308},
	[5235]={[1]=5235,[2]=5272,[3]=5309},
	[5236]={[1]=5236,[2]=5273,[3]=5310},
	[5237]={[1]=5237,[2]=5274,[3]=5311},
	[5238]={[1]=5238,[2]=5275,[3]=5312},
	[5239]={[1]=5239,[2]=5276,[3]=5313},
	[5240]={[1]=5240,[2]=5277,[3]=5314},
	[5241]={[1]=5241,[2]=5278,[3]=5315},
	[5242]={[1]=5242,[2]=5279,[3]=5316},
	[5243]={[1]=5243,[2]=5280,[3]=5317},
	[5244]={[1]=5244,[2]=5281,[3]=5318},
	[5245]={[1]=5245,[2]=5282,[3]=5319},
	[5246]={[1]=5246,[2]=5283,[3]=5320},
	[5247]={[1]=5247,[2]=5284,[3]=5321},
	[5248]={[1]=5248,[2]=5285,[3]=5322},
	[5249]={[1]=5249,[2]=5286,[3]=5323},
	[5250]={[1]=5250,[2]=5287,[3]=5324},
	[5251]={[1]=5251,[2]=5288,[3]=5325},
	[5252]={[1]=5252,[2]=5289,[3]=5326},
	[5253]={[1]=5253,[2]=5290,[3]=5327},
	[5254]={[1]=5254,[2]=5291,[3]=5328},
	[5255]={[1]=5255,[2]=5292,[3]=5329},
	[5256]={[1]=5256,[2]=5293,[3]=5330},
	[5257]={[1]=5257,[2]=5294,[3]=5331},
	[5258]={[1]=5258,[2]=5295,[3]=5332},

	[5259]={[1]=5222,[2]=5259,[3]=5296},
	[5260]={[1]=5223,[2]=5260,[3]=5297},
	[5263]={[1]=5226,[2]=5263,[3]=5300},
	[5266]={[1]=5229,[2]=5266,[3]=5303},
	[5268]={[1]=5231,[2]=5268,[3]=5305},
	[5269]={[1]=5232,[2]=5269,[3]=5306},
	[5270]={[1]=5233,[2]=5270,[3]=5307},
	[5271]={[1]=5234,[2]=5271,[3]=5308},
	[5272]={[1]=5235,[2]=5272,[3]=5309},
	[5273]={[1]=5236,[2]=5273,[3]=5310},
	[5274]={[1]=5237,[2]=5274,[3]=5311},
	[5275]={[1]=5238,[2]=5275,[3]=5312},
	[5276]={[1]=5239,[2]=5276,[3]=5313},
	[5277]={[1]=5240,[2]=5277,[3]=5314},
	[5278]={[1]=5241,[2]=5278,[3]=5315},
	[5279]={[1]=5242,[2]=5279,[3]=5316},
	[5280]={[1]=5243,[2]=5280,[3]=5317},
	[5281]={[1]=5244,[2]=5281,[3]=5318},
	[5282]={[1]=5245,[2]=5282,[3]=5319},
	[5283]={[1]=5246,[2]=5283,[3]=5320},
	[5284]={[1]=5247,[2]=5284,[3]=5321},
	[5285]={[1]=5248,[2]=5285,[3]=5322},
	[5286]={[1]=5249,[2]=5286,[3]=5323},
	[5287]={[1]=5250,[2]=5287,[3]=5324},
	[5288]={[1]=5251,[2]=5288,[3]=5325},
	[5289]={[1]=5252,[2]=5289,[3]=5326},
	[5290]={[1]=5253,[2]=5290,[3]=5327},
	[5291]={[1]=5254,[2]=5291,[3]=5328},
	[5292]={[1]=5255,[2]=5292,[3]=5329},
	[5293]={[1]=5256,[2]=5293,[3]=5330},
	[5294]={[1]=5257,[2]=5294,[3]=5331},
	[5295]={[1]=5258,[2]=5295,[3]=5332},

	[5296]={[1]=5222,[2]=5259,[3]=5296},
	[5297]={[1]=5223,[2]=5260,[3]=5297},
	[5300]={[1]=5226,[2]=5263,[3]=5300},
	[5303]={[1]=5229,[2]=5266,[3]=5303},
	[5305]={[1]=5231,[2]=5268,[3]=5305},
	[5306]={[1]=5232,[2]=5269,[3]=5306},
	[5307]={[1]=5233,[2]=5270,[3]=5307},
	[5308]={[1]=5234,[2]=5271,[3]=5308},
	[5309]={[1]=5235,[2]=5272,[3]=5309},
	[5310]={[1]=5236,[2]=5273,[3]=5310},
	[5311]={[1]=5237,[2]=5274,[3]=5311},
	[5312]={[1]=5238,[2]=5275,[3]=5312},
	[5313]={[1]=5239,[2]=5276,[3]=5313},
	[5314]={[1]=5240,[2]=5277,[3]=5314},
	[5315]={[1]=5241,[2]=5278,[3]=5315},
	[5316]={[1]=5242,[2]=5279,[3]=5316},
	[5317]={[1]=5243,[2]=5280,[3]=5317},
	[5318]={[1]=5244,[2]=5281,[3]=5318},
	[5319]={[1]=5245,[2]=5282,[3]=5319},
	[5320]={[1]=5246,[2]=5283,[3]=5320},
	[5321]={[1]=5247,[2]=5284,[3]=5321},
	[5322]={[1]=5248,[2]=5285,[3]=5322},
	[5323]={[1]=5249,[2]=5286,[3]=5323},
	[5324]={[1]=5250,[2]=5287,[3]=5324},
	[5325]={[1]=5251,[2]=5288,[3]=5325},
	[5326]={[1]=5252,[2]=5289,[3]=5326},
	[5327]={[1]=5253,[2]=5290,[3]=5327},
	[5328]={[1]=5254,[2]=5291,[3]=5328},
	[5329]={[1]=5255,[2]=5292,[3]=5329},
	[5330]={[1]=5256,[2]=5293,[3]=5330},
	[5331]={[1]=5257,[2]=5294,[3]=5331},
	[5332]={[1]=5258,[2]=5295,[3]=5332},
	--衣服
	[5333]={[1]=5333,[2]=5370,[3]=5407},
	[5334]={[1]=5334,[2]=5371,[3]=5408},
	[5337]={[1]=5337,[2]=5374,[3]=5411},
	[5340]={[1]=5340,[2]=5377,[3]=5414},
	[5341]={[1]=5341,[2]=5378,[3]=5415},
	[5342]={[1]=5342,[2]=5379,[3]=5416},
	[5343]={[1]=5343,[2]=5380,[3]=5417},
	[5344]={[1]=5344,[2]=5381,[3]=5418},
	[5345]={[1]=5345,[2]=5382,[3]=5419},
	[5346]={[1]=5346,[2]=5383,[3]=5420},
	[5347]={[1]=5347,[2]=5384,[3]=5421},
	[5348]={[1]=5348,[2]=5385,[3]=5422},
	[5349]={[1]=5349,[2]=5386,[3]=5423},
	[5350]={[1]=5350,[2]=5387,[3]=5424},
	[5351]={[1]=5351,[2]=5388,[3]=5425},
	[5352]={[1]=5352,[2]=5389,[3]=5426},
	[5353]={[1]=5353,[2]=5390,[3]=5427},
	[5354]={[1]=5354,[2]=5391,[3]=5428},
	[5355]={[1]=5355,[2]=5392,[3]=5429},
	[5356]={[1]=5356,[2]=5393,[3]=5430},
	[5357]={[1]=5357,[2]=5394,[3]=5431},
	[5358]={[1]=5358,[2]=5395,[3]=5432},
	[5359]={[1]=5359,[2]=5396,[3]=5433},
	[5360]={[1]=5360,[2]=5397,[3]=5434},
	[5361]={[1]=5361,[2]=5398,[3]=5435},
	[5362]={[1]=5362,[2]=5399,[3]=5436},
	[5363]={[1]=5363,[2]=5400,[3]=5437},
	[5364]={[1]=5364,[2]=5401,[3]=5438},
	[5365]={[1]=5365,[2]=5402,[3]=5439},
	[5366]={[1]=5366,[2]=5403,[3]=5440},
	[5367]={[1]=5367,[2]=5404,[3]=5441},
	[5368]={[1]=5368,[2]=5405,[3]=5442},
	[5369]={[1]=5369,[2]=5406,[3]=5443},

	[5370]={[1]=5333,[2]=5370,[3]=5407},
	[5371]={[1]=5334,[2]=5371,[3]=5408},
	[5374]={[1]=5337,[2]=5374,[3]=5411},
	[5377]={[1]=5340,[2]=5377,[3]=5414},
	[5378]={[1]=5341,[2]=5378,[3]=5415},
	[5379]={[1]=5342,[2]=5379,[3]=5416},
	[5380]={[1]=5343,[2]=5380,[3]=5417},
	[5381]={[1]=5344,[2]=5381,[3]=5418},
	[5382]={[1]=5345,[2]=5382,[3]=5419},
	[5383]={[1]=5346,[2]=5383,[3]=5420},
	[5384]={[1]=5347,[2]=5384,[3]=5421},
	[5385]={[1]=5348,[2]=5385,[3]=5422},
	[5386]={[1]=5349,[2]=5386,[3]=5423},
	[5387]={[1]=5350,[2]=5387,[3]=5424},
	[5388]={[1]=5351,[2]=5388,[3]=5425},
	[5389]={[1]=5352,[2]=5389,[3]=5426},
	[5390]={[1]=5353,[2]=5390,[3]=5427},
	[5391]={[1]=5354,[2]=5391,[3]=5428},
	[5392]={[1]=5355,[2]=5392,[3]=5429},
	[5393]={[1]=5356,[2]=5393,[3]=5430},
	[5394]={[1]=5357,[2]=5394,[3]=5431},
	[5395]={[1]=5358,[2]=5395,[3]=5432},
	[5396]={[1]=5359,[2]=5396,[3]=5433},
	[5397]={[1]=5360,[2]=5397,[3]=5434},
	[5398]={[1]=5361,[2]=5398,[3]=5435},
	[5399]={[1]=5362,[2]=5399,[3]=5436},
	[5400]={[1]=5363,[2]=5400,[3]=5437},
	[5401]={[1]=5364,[2]=5401,[3]=5438},
	[5402]={[1]=5365,[2]=5402,[3]=5439},
	[5403]={[1]=5366,[2]=5403,[3]=5440},
	[5404]={[1]=5367,[2]=5404,[3]=5441},
	[5405]={[1]=5368,[2]=5405,[3]=5442},
	[5406]={[1]=5369,[2]=5406,[3]=5443},

	[5407]={[1]=5333,[2]=5370,[3]=5407},
	[5408]={[1]=5334,[2]=5371,[3]=5408},
	[5411]={[1]=5337,[2]=5374,[3]=5411},
	[5414]={[1]=5340,[2]=5377,[3]=5414},
	[5415]={[1]=5341,[2]=5378,[3]=5415},
	[5416]={[1]=5342,[2]=5379,[3]=5416},
	[5417]={[1]=5343,[2]=5380,[3]=5417},
	[5418]={[1]=5344,[2]=5381,[3]=5418},
	[5419]={[1]=5345,[2]=5382,[3]=5419},
	[5420]={[1]=5346,[2]=5383,[3]=5420},
	[5421]={[1]=5347,[2]=5384,[3]=5421},
	[5422]={[1]=5348,[2]=5385,[3]=5422},
	[5423]={[1]=5349,[2]=5386,[3]=5423},
	[5424]={[1]=5350,[2]=5387,[3]=5424},
	[5425]={[1]=5351,[2]=5388,[3]=5425},
	[5426]={[1]=5352,[2]=5389,[3]=5426},
	[5427]={[1]=5353,[2]=5390,[3]=5427},
	[5428]={[1]=5354,[2]=5391,[3]=5428},
	[5429]={[1]=5355,[2]=5392,[3]=5429},
	[5430]={[1]=5356,[2]=5393,[3]=5430},
	[5431]={[1]=5357,[2]=5394,[3]=5431},
	[5432]={[1]=5358,[2]=5395,[3]=5432},
	[5433]={[1]=5359,[2]=5396,[3]=5433},
	[5434]={[1]=5360,[2]=5397,[3]=5434},
	[5435]={[1]=5361,[2]=5398,[3]=5435},
	[5436]={[1]=5362,[2]=5399,[3]=5436},
	[5437]={[1]=5363,[2]=5400,[3]=5437},
	[5438]={[1]=5364,[2]=5401,[3]=5438},
	[5439]={[1]=5365,[2]=5402,[3]=5439},
	[5440]={[1]=5366,[2]=5403,[3]=5440},
	[5441]={[1]=5367,[2]=5404,[3]=5441},
	[5442]={[1]=5368,[2]=5405,[3]=5442},
	[5443]={[1]=5369,[2]=5406,[3]=5443},
	--鞋子
	[5444]={[1]=5444,[2]=5481,[3]=5518},
	[5445]={[1]=5445,[2]=5482,[3]=5519},
	[5448]={[1]=5448,[2]=5485,[3]=5522},
	[5451]={[1]=5451,[2]=5488,[3]=5525},
	[5453]={[1]=5453,[2]=5490,[3]=5527},
	[5454]={[1]=5454,[2]=5491,[3]=5528},
	[5455]={[1]=5455,[2]=5492,[3]=5529},
	[5456]={[1]=5456,[2]=5493,[3]=5530},
	[5457]={[1]=5457,[2]=5494,[3]=5531},
	[5458]={[1]=5458,[2]=5495,[3]=5532},
	[5459]={[1]=5459,[2]=5496,[3]=5533},
	[5460]={[1]=5460,[2]=5497,[3]=5534},
	[5461]={[1]=5461,[2]=5498,[3]=5535},
	[5462]={[1]=5462,[2]=5499,[3]=5536},
	[5463]={[1]=5463,[2]=5500,[3]=5537},
	[5464]={[1]=5464,[2]=5501,[3]=5538},
	[5465]={[1]=5465,[2]=5502,[3]=5539},
	[5466]={[1]=5466,[2]=5503,[3]=5540},
	[5467]={[1]=5467,[2]=5504,[3]=5541},
	[5468]={[1]=5468,[2]=5505,[3]=5542},
	[5469]={[1]=5469,[2]=5506,[3]=5543},
	[5470]={[1]=5470,[2]=5507,[3]=5544},
	[5471]={[1]=5471,[2]=5508,[3]=5545},
	[5472]={[1]=5472,[2]=5509,[3]=5546},
	[5473]={[1]=5473,[2]=5510,[3]=5547},
	[5474]={[1]=5474,[2]=5511,[3]=5548},
	[5475]={[1]=5475,[2]=5512,[3]=5549},
	[5476]={[1]=5476,[2]=5513,[3]=5550},
	[5477]={[1]=5477,[2]=5514,[3]=5551},
	[5478]={[1]=5478,[2]=5515,[3]=5552},
	[5479]={[1]=5479,[2]=5516,[3]=5553},
	[5480]={[1]=5480,[2]=5517,[3]=5554},

	[5481]={[1]=5444,[2]=5481,[3]=5518},
	[5482]={[1]=5445,[2]=5482,[3]=5519},
	[5485]={[1]=5448,[2]=5485,[3]=5522},
	[5488]={[1]=5451,[2]=5488,[3]=5525},
	[5490]={[1]=5453,[2]=5490,[3]=5527},
	[5491]={[1]=5454,[2]=5491,[3]=5528},
	[5492]={[1]=5455,[2]=5492,[3]=5529},
	[5493]={[1]=5456,[2]=5493,[3]=5530},
	[5494]={[1]=5457,[2]=5494,[3]=5531},
	[5495]={[1]=5458,[2]=5495,[3]=5532},
	[5496]={[1]=5459,[2]=5496,[3]=5533},
	[5497]={[1]=5460,[2]=5497,[3]=5534},
	[5498]={[1]=5461,[2]=5498,[3]=5535},
	[5499]={[1]=5462,[2]=5499,[3]=5536},
	[5500]={[1]=5463,[2]=5500,[3]=5537},
	[5501]={[1]=5464,[2]=5501,[3]=5538},
	[5502]={[1]=5465,[2]=5502,[3]=5539},
	[5503]={[1]=5466,[2]=5503,[3]=5540},
	[5504]={[1]=5467,[2]=5504,[3]=5541},
	[5505]={[1]=5468,[2]=5505,[3]=5542},
	[5506]={[1]=5469,[2]=5506,[3]=5543},
	[5507]={[1]=5470,[2]=5507,[3]=5544},
	[5508]={[1]=5471,[2]=5508,[3]=5545},
	[5509]={[1]=5472,[2]=5509,[3]=5546},
	[5510]={[1]=5473,[2]=5510,[3]=5547},
	[5511]={[1]=5474,[2]=5511,[3]=5548},
	[5512]={[1]=5475,[2]=5512,[3]=5549},
	[5513]={[1]=5476,[2]=5513,[3]=5550},
	[5514]={[1]=5477,[2]=5514,[3]=5551},
	[5515]={[1]=5478,[2]=5515,[3]=5552},
	[5516]={[1]=5479,[2]=5516,[3]=5553},
	[5517]={[1]=5480,[2]=5517,[3]=5554},

	[5518]={[1]=5444,[2]=5481,[3]=5518},
	[5519]={[1]=5445,[2]=5482,[3]=5519},
	[5522]={[1]=5448,[2]=5485,[3]=5522},
	[5525]={[1]=5451,[2]=5488,[3]=5525},
	[5527]={[1]=5453,[2]=5490,[3]=5527},
	[5528]={[1]=5454,[2]=5491,[3]=5528},
	[5529]={[1]=5455,[2]=5492,[3]=5529},
	[5530]={[1]=5456,[2]=5493,[3]=5530},
	[5531]={[1]=5457,[2]=5494,[3]=5531},
	[5532]={[1]=5458,[2]=5495,[3]=5532},
	[5533]={[1]=5459,[2]=5496,[3]=5533},
	[5534]={[1]=5460,[2]=5497,[3]=5534},
	[5535]={[1]=5461,[2]=5498,[3]=5535},
	[5536]={[1]=5462,[2]=5499,[3]=5536},
	[5537]={[1]=5463,[2]=5500,[3]=5537},
	[5538]={[1]=5464,[2]=5501,[3]=5538},
	[5539]={[1]=5465,[2]=5502,[3]=5539},
	[5540]={[1]=5466,[2]=5503,[3]=5540},
	[5541]={[1]=5467,[2]=5504,[3]=5541},
	[5542]={[1]=5468,[2]=5505,[3]=5542},
	[5543]={[1]=5469,[2]=5506,[3]=5543},
	[5544]={[1]=5470,[2]=5507,[3]=5544},
	[5545]={[1]=5471,[2]=5508,[3]=5545},
	[5546]={[1]=5472,[2]=5509,[3]=5546},
	[5547]={[1]=5473,[2]=5510,[3]=5547},
	[5548]={[1]=5474,[2]=5511,[3]=5548},
	[5549]={[1]=5475,[2]=5512,[3]=5549},
	[5550]={[1]=5476,[2]=5513,[3]=5550},
	[5551]={[1]=5477,[2]=5514,[3]=5551},
	[5552]={[1]=5478,[2]=5515,[3]=5552},
	[5553]={[1]=5479,[2]=5516,[3]=5553},
	[5554]={[1]=5480,[2]=5517,[3]=5554},
}

-----------------------------变性---------------------------
function change_sex(playerid,sex,equip)
	-- look(sex,1)
	-- look(equip,1)
	if 0 == CheckGoods(793,1,1,playerid,'变性') then
		return
	end
	local peiou=CI_GetPlayerData(69)
	if type(peiou)==type("") then --结婚
		return 
	end

	if equip then 
		--换装备
		local detail = CI_GetEquipDetails(0,equip)
		if detail == nil then return end
		local school=CI_GetPlayerData(2)
		local end_index=change_Weaponconf[equip][school*10+sex]
		detail.index=end_index
		CI_UpdateEquipDetails(0, detail)
	end

	if 0 == CheckGoods(793,1,0,playerid,'变性') then
		return
	end
	--c接口
	CI_SetPlayerData(7,sex)
	UpdateCityImageIDEx(playerid)
	RPC('change_res',1)--变性成功
end
-----------------------------转职---------------------------


function change_school(playerid,school,equip)
	if 0 == CheckGoods(794,1,1,playerid,'转职') then
		return
	end
	
	--换装备
	local end_index
	local detail
	for k,v in pairs(equip) do
		if k<4 and k>=0 then
			
			if k==0 then 
				local sex=CI_GetPlayerData(11)
				end_index=change_Weaponconf[v][school*10+sex]
			else
				end_index=change_otherconf[v][school]
			end
			detail = CI_GetEquipDetails(k,v)
			if detail == nil then return end
			
			detail.index=end_index
			CI_UpdateEquipDetails(k, detail)
		end
	end

	--换觉醒技能
	local old_school=CI_GetPlayerData(2)
	local old_jxlv
	if old_school == 1 then
		old_jxlv=CI_GetSkillLevel(1,108)
		CI_SetSkillLevel(1,1,0)
		CI_SetSkillLevel(1,108,0)
	elseif old_school == 2 then
		old_jxlv=CI_GetSkillLevel(1,123)
		CI_SetSkillLevel(1,11,0)
		CI_SetSkillLevel(1,123,0)
	elseif old_school == 3 then
		old_jxlv=CI_GetSkillLevel(1,124)
		CI_SetSkillLevel(1,21,0)
		CI_SetSkillLevel(1,124,0)
		
	end

	old_jxlv=old_jxlv or 1
	if old_jxlv <=0 then 
		old_jxlv=1
	end
	-- local a
	-- if school == 1 then
	-- 	CI_SetSkillLevel(1,108,old_jxlv,12 )
	-- 	 a= CI_LearnSkill(1,1)
	-- elseif school == 2 then
	-- 	CI_SetSkillLevel(1,123,old_jxlv ,12)
	-- 	 a= CI_LearnSkill(1,11)
	-- elseif school == 3 then
	-- 	CI_SetSkillLevel(1,124,old_jxlv ,12)
	-- 	 a= CI_LearnSkill(1,21)
	-- end
	-- look(a,1)
	

	--洗技能
	Skill_kill(playerid,0,0,1)
	--洗天赋
	Skill_kill(playerid,1,0,1)
	
	--c接口
	CI_SetPlayerData(8,school)

	if school == 1 then
		CI_SetSkillLevel(1,108,old_jxlv,12 )
		CI_LearnSkill(1,1)
	elseif school == 2 then
		CI_SetSkillLevel(1,123,old_jxlv ,12)
		CI_LearnSkill(1,11)
	elseif school == 3 then
		CI_SetSkillLevel(1,124,old_jxlv ,12)
		CI_LearnSkill(1,21)
	end
	-- look(a,1)

	
	if 0 == CheckGoods(794,1,0,playerid,'转职') then
		return
	end
	UpdateCityImageIDEx(playerid)



	RPC('change_res',2)--转职成功
end